{
  "version": "2.0.0",
  "tasks": [
    {
      "type": "shell",
      "label": "Build harness (release)",
      "command": "/opt/homebrew/opt/llvm/bin/clang++",
      "args": [
        "-std=gnu++20","-O2","-Wall","-Wextra",
        "-I","${workspaceFolder}/include",
        "${workspaceFolder}/src/main.cpp",
        "${workspaceFolder}/src/ref.cpp",
        "${workspaceFolder}/src/user.cpp",
        "${workspaceFolder}/src/samples.cpp",
        "-o","${workspaceFolder}/bin/harness"
      ],
      "options": { "cwd": "${workspaceFolder}" },
      "problemMatcher": ["$gcc"],
      "group": { "kind": "build", "isDefault": true }
    },
    {
      "type": "shell",
      "label": "Build harness (sanitizers, fail-fast)",
      "command": "/opt/homebrew/opt/llvm/bin/clang++",
      "args": [
        "-std=gnu++20",
        "-O1","-g","-fno-omit-frame-pointer",
        "-Wall","-Wextra","-Werror",
        "-fsanitize=address,undefined",
        "-fno-sanitize-recover=all",
        "-I","${workspaceFolder}/include",
        "-D_LIBCPP_HARDENING_MODE=_LIBCPP_HARDENING_MODE_DEBUG",
        "${workspaceFolder}/src/main.cpp",
        "${workspaceFolder}/src/ref.cpp",
        "${workspaceFolder}/src/user.cpp",
        "${workspaceFolder}/src/samples.cpp",
        "-o","${workspaceFolder}/bin/harness_san"
      ],
      "options": {
        "cwd": "${workspaceFolder}",
        "env": {
          "ASAN_OPTIONS": "abort_on_error=1:detect_leaks=1:halt_on_error=1:symbolize=1",
          "UBSAN_OPTIONS": "print_stacktrace=1:halt_on_error=1:abort_on_error=1"
        }
      },
      "problemMatcher": ["$gcc"]
    }
  ]
}